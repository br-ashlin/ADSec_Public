#Create Security Groups to match name of Servers within Domain
#Each Security Group to host Service accounts that will need Local Admin on each individual Server
#GPOs to push Local Admin memberships should contain 'DOMAIN\%COMPUTERNAME%' to provide newly created Security Group membership to Member server 'Local Admin Membership'


Import-Module ActiveDirectory
#Get ADCOmputer with OperatingSystem Like *Server* and LastlogonDate less than $DaysInactive to Array

$DaysInactive = 180
$InactiveDate = (Get-Date).Adddays(-($DaysInactive))
$groups = Get-ADComputer -Filter {OperatingSystem -Like "*Server*" -and LastlogonDate -lt $InactiveDate} | Select Name

#Foreach Loop to create each Security Group in desired Path. Selecting. This will not override any existing groups with  the same name
foreach ($group in $groups) {
New-ADGroup -Name $group.name -Path “OU=Servers,OU=Groups,OU=T1,DC=asia,DC=domain,DC=com” -Description “Groups to set local admins on servers” -GroupCategory Security -GroupScope Global -ErrorAction SilentlyContinue -Verbose
} 

